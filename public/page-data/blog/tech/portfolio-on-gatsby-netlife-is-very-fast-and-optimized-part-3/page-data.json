{"componentChunkName":"component---src-templates-one-blog-post-page-template-js","path":"/blog/tech/portfolio-on-gatsby-netlife-is-very-fast-and-optimized-part-3/","result":{"pageContext":{"data":{"id":"9d8dbe96-a53d-5e93-bf37-abed620538bd","bodyRu":{"childContentfulRichText":{"html":"<h4>Сегодня мы настроим необходимые плагины для Гэтсби.JS.</h4><p>Я надеюсь, что мы справились с тем, что было упомянуто в <a href=\"https://alex-vorotov.gq/blog/tech/portfolio-on-gatsby-netlife-is-very-fast-and-optimized-part-2/\">предыдущей статье</a>, и теперь у нас есть действительный домен, и мы можем начать настраивать наше приложение.\nПрежде чем приступить к рассмотрению элементов страницы как в частности тайтлов и прочего, так и c точки зрения SEO, давайте сделаем оговорку: SEO строится не только на этих факторах. Она также включает в себя такие понятия, как действительная карта сайта, робот.txt и т. д.\nЕсть много моментов, благодаря Гэтсби.js есть много допустимых плагинов, чтобы минимизировать наши проблемы. Весь код можно посмотреть в моем <a href=\"https://github.com/al-vorotov/envs\">Github</a>, и я постараюсь описать, для чего мы будем его использовать.</p><h4>\nУстановка энвайроментола.</h4><p>\nГэтсби.js по умолчанию отслеживает зависимости в gatsby-config.js, но мы можем изменить его поведение для различных сред, создав gatsby-config.файлы prod и env соответственно. env.prod и env.stage, в которой мы будем скрывать наши необходимые переменные в будущем.\nВ Гэтсби-конфиг кладем код:</p><p><code>const gatsbyConfig = require(`./gatsby-config-generator`)\ntry {\n  require(&#39;dotenv&#39;).config({\n    path: `.env.staging`,\n  })\n} catch (e) {\n  console.error(\n    &#39;Cannot find correct environment variables, reverting to dummies&#39;\n  )\n  throw Error(&#39;No ENV file found&#39;)\n}\n\nmodule.exports = gatsbyConfig()</code></p><p><code>GATSBY_ENV=&#39;staging&#39;\nGATSBY_GOOGLE_ANALYTICS_KEY=&#39;&#39;</code></p><p>И теперь нам остается только создать документ gatsby-config-generator.js, внутри которого будут располагаться настройки плагинов:</p><p><code>module.exports = () =&gt; ({\n  siteMetadata: {},\n  plugins: [],\n})</code></p><p>Примерная структура файлов, которую мы должны получить.</p><img \nsrc=\"//images.ctfassets.net/wj6pzgesw36a/2jIKYvrOWUymWOySEl2Uek/b6422efce97f7049758d06671be46a57/__________________________2020-04-20____23.32.45.png\" \nalt=\"Not more about gatsby structure.\"\n/><p></p><p>Немного больше об этом можно <a href=\"https://www.gatsbyjs.org/docs/environment-variables/\">прочитать здесь</a>.</p><h4>Мой набор плагинов</h4><p>Я оставлю все плагины, которые без настроек, без описания. Узнать больше о них вы можете в <a href=\"https://www.gatsbyjs.org/plugins/\">официальной документации</a>. Я считаю их проверенными и абсолютно валидными, каждый из этих плагинов пригодиться нам в будущем. </p><p><code>`gatsby-plugin-react-helmet`,\n`gatsby-transformer-sharp`,\n`gatsby-plugin-sharp`,\n`gatsby-plugin-offline`,\n`gatsby-plugin-sass`,</code></p><p>Теперь по конфигурациям.</p><p><code>{\n  resolve: `gatsby-plugin-sitemap`,\n  options: {\n    output: `/sitemap.xml`,\n  },\n},</code></p><p>gatsby-plugin-sitemap дает нам возможность создания динамической сайтмап, которая собирает в каждый билд актуальные значения. В опциях указываем желаемый путь выхода файла.</p><p><code>const {\n  NODE_ENV,\n  URL: NETLIFY_SITE_URL = &#39;https://www.you-site/&#39;,\n  DEPLOY_PRIME_URL: NETLIFY_DEPLOY_URL = NETLIFY_SITE_URL,\n  CONTEXT: NETLIFY_ENV = NODE_ENV,\n} = process.env\nconst isNetlifyProduction = NETLIFY_ENV === &#39;production&#39;\nconst siteUrl = isNetlifyProduction ? NETLIFY_SITE_URL : NETLIFY_DEPLOY_URL</code></p><p><code>{\n  resolve: &#39;gatsby-plugin-robots-txt&#39;,\n  options: {\n    resolveEnv: () =&gt; NETLIFY_ENV,\n    env: {\n      production: {\n        policy: [{ userAgent: &#39;*&#39; }],\n      },\n      &#39;branch-deploy&#39;: {\n        policy: [{ userAgent: &#39;*&#39;, disallow: [&#39;/&#39;] }],\n        sitemap: null,\n        host: null,\n      },\n      &#39;deploy-preview&#39;: {\n        policy: [{ userAgent: &#39;*&#39;, disallow: [&#39;/&#39;] }],\n        sitemap: null,\n        host: null,\n      },\n    },\n  },\n},</code></p><p><code>gatsby-plugin-robots-txt создает robots.txt</code></p><p><code>{\n  resolve: `gatsby-plugin-manifest`,\n  options: {\n    name: ``,\n    short_name: ``,\n    start_url: `/`,\n    background_color: `#663399`,\n    theme_color: `#663399`,\n    display: `minimal-ui`,\n    icon: `src/assets/images/you-icon.png`,\n  },\n},</code></p><p><code>gatsby-plugin-manifest </code>необходим для создания<a href=\"https://ru.wikipedia.org/wiki/%D0%9F%D1%80%D0%BE%D0%B3%D1%80%D0%B5%D1%81%D1%81%D0%B8%D0%B2%D0%BD%D0%BE%D0%B5_%D0%B2%D0%B5%D0%B1-%D0%BF%D1%80%D0%B8%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5\"> PWA </a> . В опции необходимо передать сконфигурированный manifest.json. Для его создания можно воспользоваться <a href=\"https://app-manifest.firebaseapp.com/\">генератором манифеста</a>.</p><p>Этих плагинов будет достаточно для создания оптимизированного приложения на  gatsby.js . Также вы можете найти для себя все необходимое в документации.</p><h4>Спасибо за внимание!</h4><p></p>"}},"body":{"childContentfulRichText":{"html":"<h4>Today we will configure the necessary plugins for Gatsby.js .</h4><p>\nI hope we have managed with what was mentioned in the <a href=\"https://alex-vorotov.gq/blog/tech/portfolio-on-gatsby-netlife-is-very-fast-and-optimized-part-2/\">last article</a> and now we have a valid domain and can start configuring our application.\nBefore proceeding to the consideration of page elements both in particular and with\nfrom the point of view of SEO, let&#39;s make a reservation: SEO is not only based on these factors build. It also includes concepts such as valid siteMap, robots.txt, etc.\nThere are a lot of points, thanks to Gatsby.js has a lot of valid plugins to minimize our problems. All the code can be viewed in my <a href=\"https://github.com/al-vorotov/envs\">Github</a> and I will try to describe what we will use it for.</p><h4>Setting enviromental.</h4><p>Gatsby.js by default, it monitors dependencies in gatsby-config.js but we can change its behavior for different environments by creating gatsby-config.prod and env files, respectively. env. production and. env.staging, in which we will hide our necessary variables in the future.\nIn the gatsby-config putting the code:</p><p><code>const gatsbyConfig = require(`./gatsby-config-generator`)\n\ntry {\n  require(&#39;dotenv&#39;).config({\n    path: `.env.staging`,\n  })\n} catch (e) {\n  console.error(\n    &#39;Cannot find correct environment variables, reverting to dummies&#39;\n  )\n  throw Error(&#39;No ENV file found&#39;)\n}\n\nmodule.exports = gatsbyConfig()</code></p><p>.env.staging put this</p><p><code>GATSBY_ENV=&#39;staging&#39;\nGATSBY_GOOGLE_ANALYTICS_KEY=&#39;&#39;</code></p><p>And now all we have to do is create a gatsby-config-generator that will contain the plugin settings:</p><p><code>module.exports = () =&gt; ({\n  siteMetadata: {},\n  plugins: [],\n})</code></p><p>it is looks like are this:</p><img \nsrc=\"//images.ctfassets.net/wj6pzgesw36a/2jIKYvrOWUymWOySEl2Uek/b6422efce97f7049758d06671be46a57/__________________________2020-04-20____23.32.45.png\" \nalt=\"Not more about gatsby structure.\"\n/><p></p><p>A little more about this can be read here.</p><h4>\nMy set of plug-ins</h4><p>\nI will leave all plugins that have no settings without a description. You can find out more about them in the <a href=\"https://www.gatsbyjs.org/plugins/\">official documentation</a>. I think they are absolutely valid and tested each of these plugins useful to us in the future.</p><p><code>`gatsby-plugin-react-helmet`,\n`gatsby-transformer-sharp`,\n`gatsby-plugin-sharp`,\n`gatsby-plugin-offline`,\n`gatsby-plugin-sass`,</code></p><p>and configuration together</p><p><code>{\n  resolve: `gatsby-plugin-sitemap`,\n  options: {\n    output: `/sitemap.xml`,\n  },\n},</code></p><p>gatsby-plugin-sitemap this allows us to create a dynamic site map that collects current values in each build. In the options, specify the desired file exit path.</p><p><code>const {\n  NODE_ENV,\n  URL: NETLIFY_SITE_URL = &#39;https://www.you-site/&#39;,\n  DEPLOY_PRIME_URL: NETLIFY_DEPLOY_URL = NETLIFY_SITE_URL,\n  CONTEXT: NETLIFY_ENV = NODE_ENV,\n} = process.env\nconst isNetlifyProduction = NETLIFY_ENV === &#39;production&#39;\nconst siteUrl = isNetlifyProduction ? NETLIFY_SITE_URL : NETLIFY_DEPLOY_URL</code></p><p><code>{\n  resolve: &#39;gatsby-plugin-robots-txt&#39;,\n  options: {\n    resolveEnv: () =&gt; NETLIFY_ENV,\n    env: {\n      production: {\n        policy: [{ userAgent: &#39;*&#39; }],\n      },\n      &#39;branch-deploy&#39;: {\n        policy: [{ userAgent: &#39;*&#39;, disallow: [&#39;/&#39;] }],\n        sitemap: null,\n        host: null,\n      },\n      &#39;deploy-preview&#39;: {\n        policy: [{ userAgent: &#39;*&#39;, disallow: [&#39;/&#39;] }],\n        sitemap: null,\n        host: null,\n      },\n    },\n  },\n},</code></p><p>gatsby-plugin-robots-txt created robots.txt</p><p><code>{\n  resolve: `gatsby-plugin-manifest`,\n  options: {\n    name: ``,\n    short_name: ``,\n    start_url: `/`,\n    background_color: `#663399`,\n    theme_color: `#663399`,\n    display: `minimal-ui`,\n    icon: `src/assets/images/you-icon.png`,\n  },\n},</code></p><p>gatsby-plugin-manifest required for creation<a href=\"https://ru.wikipedia.org/wiki/%D0%9F%D1%80%D0%BE%D0%B3%D1%80%D0%B5%D1%81%D1%81%D0%B8%D0%B2%D0%BD%D0%BE%D0%B5_%D0%B2%D0%B5%D0%B1-%D0%BF%D1%80%D0%B8%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5\"> PWA </a>  </p><p>These plugins will be enough to create an optimized app on gatsby.js . You can also find everything you need in the documentation.</p><h4>Thank you for attention!</h4><p></p>"}},"category":"Технологии","categoryEn":"tech","date":"2020-04-19T00:00+03:00","title":{"childContentfulRichText":{"html":"<h2>Portfolio on Gatsby &amp; Netlife is very fast and optimized. Part-3</h2><p></p>"}},"titleRu":{"childContentfulRichText":{"html":"<h2>Портфолио на Gatsby &amp; Netlife очень быстро и оптимизированно. Часть-3</h2><p></p>"}},"slug":"portfolio-on-gatsby-netlife-is-very-fast-and-optimized-part-3","thumb":{"file":{"url":"//images.ctfassets.net/wj6pzgesw36a/59cwt7E7H9HHxHohj2EpOc/3eddb884c20d6de3b5e5fd912630860a/thumbForPost.jpg"}},"header":{"file":{"url":"//images.ctfassets.net/wj6pzgesw36a/2ECNWrw9IOlsrYFfX25k3H/6eaba880dbfe0a590ac40399e211c42d/header-gatsby-part-3.jpg"}},"avatar":{"file":{"url":"//images.ctfassets.net/wj6pzgesw36a/4hFMvKnI7cLGtybIFLL1X6/339e61ebbf8262d7f87e7919466f0d01/avatar.jpeg"}},"postedBy":"Alexander Vorotov","postedByRu":"Александр Воротов","titleForSeo":"Portfolio on Gatsby & Netlife is very fast and optimized. Part-3"}}},"staticQueryHashes":[]}